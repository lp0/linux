// GPIO_ACTIVE_LOW #include <dt-bindings/gpio/gpio.h>

/ {
	#address-cells = <1>;
	#size-cells = <1>;
	compatible = "brcm,bcm63168";

	cpus {
		#address-cells = <1>;
		#size-cells = <0>;

		mips-hpt-frequency = <200000000>;

		cpu@0 {
			compatible = "brcm,bmips4350";
			device_type = "cpu";
			reg = <0>;
		};

		cpu@1 {
			compatible = "brcm,bmips4350";
			device_type = "cpu";
			reg = <1>;
		};
	};

	clocks {
		periph_osc: periph_osc {
			compatible = "fixed-clock";
			#clock-cells = <0>;
			clock-frequency = <50000000>;
		};
	};

	regulators {
		compatible = "simple-bus";
		#address-cells = <0>;
		#size-cells = <0>;

		sar {
			compatible = "regulator-fixed";
			regulator-name = "sar_power";
			gpio = <&misc_iddq 0 1>;
			startup-delay-us = <100000>;
		};

		ipsec {
			compatible = "regulator-fixed";
			regulator-name = "ipsec_power";
			gpio = <&misc_iddq 1 1>;
			startup-delay-us = <100000>;
		};

		mips {
			compatible = "regulator-fixed";
			regulator-name = "mips_power";
			gpio = <&misc_iddq 2 1>;
			startup-delay-us = <100000>;
		};

		dect {
			compatible = "regulator-fixed";
			regulator-name = "dect_power";
			gpio = <&misc_iddq 3 1>;
			startup-delay-us = <100000>;
		};

		power_usbh: usbh {
			compatible = "regulator-fixed";
			regulator-name = "usbh_power";
			gpio = <&misc_iddq 4 1>;
			startup-delay-us = <100000>;
		};

		usbd {
			compatible = "regulator-fixed";
			regulator-name = "usbd_power";
			gpio = <&misc_iddq 5 1>;
			startup-delay-us = <100000>;
		};

		power_robosw: robosw {
			compatible = "regulator-fixed";
			regulator-name = "robosw_power";
			gpio = <&misc_iddq 6 1>;
			startup-delay-us = <100000>;
		};

		pcm {
			compatible = "regulator-fixed";
			regulator-name = "pcm_power";
			gpio = <&misc_iddq 7 1>;
			startup-delay-us = <100000>;
		};

		periph {
			compatible = "regulator-fixed";
			regulator-name = "periph_power";
			gpio = <&misc_iddq 8 1>;
			startup-delay-us = <100000>;
		};

		vdsl_phy {
			compatible = "regulator-fixed";
			regulator-name = "vdsl_phy_power";
			gpio = <&misc_iddq 9 1>;
			startup-delay-us = <100000>;
		};

		vdsl_mips {
			compatible = "regulator-fixed";
			regulator-name = "vdsl_mips_power";
			gpio = <&misc_iddq 10 1>;
			startup-delay-us = <100000>;
		};

		fap {
			compatible = "regulator-fixed";
			regulator-name = "fap_power";
			gpio = <&misc_iddq 11 1>;
			startup-delay-us = <100000>;
		};

		pcie {
			compatible = "regulator-fixed";
			regulator-name = "pcie_power";
			gpio = <&misc_iddq 12 1>;
			startup-delay-us = <100000>;
		};

		wlan_pads {
			compatible = "regulator-fixed";
			regulator-name = "wlan_pads_power";
			gpio = <&misc_iddq 13 1>;
			startup-delay-us = <100000>;
		};

		gmac {
			compatible = "regulator-fixed";
			regulator-name = "gmac_power";
			gpio = <&misc_iddq 18 1>;
			startup-delay-us = <100000>;
		};
	};

	aliases {
		uart0 = &uart0;
		uart1 = &uart1;
	};

	cpu_intc: interrupt-controller {
		#address-cells = <0>;
		compatible = "mti,cpu-interrupt-controller";

		interrupt-controller;
		#interrupt-cells = <1>;
	};

	ubus {
		compatible = "simple-bus";
		#address-cells = <1>;
		#size-cells = <1>;
		ranges;

		periph_intc: interrupt-controller@0x10000000 {
			compatible = "brcm,bcm63168-l1-intc";
			reg = <0x10000020 0x20>,
			      <0x10000040 0x20>;
			interrupt-parent = <&cpu_intc>;
			interrupts = <2>, <3>;

			interrupt-controller;
			#interrupt-cells = <1>;
		};

		/* TODO  iudma, ethsw, nvram, nand, dsl */

		periph_clk: periph_clk@0x10000004 {
			compatible = "mmio-gate-clock";
			reg = <0x10000004 0x4>;
			clocks = <&periph_osc>;

			#clock-cells = <1>;
			clock-indices =
				<1>,          <2>,        <3>,       <4>,     <5>,
				<6>,          <7>,        <8>,       <9>,     <10>,
				<11>,         <12>,       <13>,      <14>,    <15>,
				<16>,         <17>,       <18>,      <19>,    <20>,
				<27>,         <31>;
			clock-output-names =
				"vdsl_qproc", "vdsl_afe", "vdsl",    "mips",  "wlan_ocp",
				"dect",       "fap0",     "fap1",    "sar",   "robosw",
				"pcm",        "usbd",     "usbh",    "ipsec", "spi",
				"hsspi",      "pcie",     "phymips", "gmac",  "nand",
				"tbus",       "robosw250";
		};

		timer_clk: timer_clk@0x100000ac {
			compatible = "mmio-gate-clock";
			reg = <0x100000ac 0x4>;
			clocks = <&periph_osc>;

			#clock-cells = <1>;
			clock-indices = <11>, <15>, <17>, <18>;
			clock-output-names = "fap1_pll", "fap2_pll", "uto_extin", "usb_ref";
		};

		perf: syscon@0x10000008 {
			compatible = "syscon";
			reg = <0x10000008 0x04>;
		};

		reboot {
			compatible = "syscon-reboot";
			regmap = <&perf>;
			offset = <0x0>;
			mask = <0x1>;
		};

		perf_soft_rst: reset-controller@0xb0000010 {
			compatible = "brcm,bcm63168-reset", "brcm,bcm63xx-reset";
			reg = <0x10000010 0x4>;

			#reset-cells = <1>;
		};

		timer: timer@0x10000080 {
			compatible = "brcm,bcm63168-timer", "brcm,bcm63xx-timer";
			reg = <0x10000080 0x0c>;
			interrupt-parent = <&periph_intc>;
			interrupts = <0>;
			clocks = <&periph_osc>;

			interrupt-controller;
			#interrupt-cells = <1>;
		};

		wdt: watchdog@0x1000009c {
			compatible = "brcm,bcm63168-wdt", "brcm,bcm63xx-wdt";
			reg = <0x1000009c 0x0c>;
			interrupt-parent = <&timer>;
			interrupts = <3>;
			clocks = <&periph_osc>;
		};

		misc_iddq: gpio@0xb000184c {
			compatible = "brcm,bcm63xx-gpio";
			reg = <0x1000184c 0x4>;
			reg-names = "dat";
			big-endian;

			gpio-controller;
			#gpio-cells = <2>;
		};

		leds0: led-controller@0x10001900 {
			compatible = "brcm,bcm63168-leds", "brcm,bcm6328-leds";
			reg = <0x10001900 0x24>;

			#address-cells = <1>;
			#size-cells = <0>;
			brcm,serial-leds;
		};

		uart0: serial@0x10000180 {
			compatible = "brcm,bcm63168-uart", "brcm,bcm6345-uart";
			reg = <0x10000180 0x20>;
			interrupt-parent = <&periph_intc>;
			interrupts = <5>;
			clocks = <&periph_osc>;
			status = "disabled";
		};

		uart1: serial@0x100001a0 {
			compatible = "brcm,bcm63168-uart", "brcm,bcm6345-uart";
			reg = <0x100001a0 0x20>;
			interrupt-parent = <&periph_intc>;
			interrupts = <34>;
			clocks = <&periph_osc>;
			status = "disabled";
		};

		enetdma0: dma-controller@0x1000d800 {
			compatible = "brcm,bcm63168-iudma", "brcm,bcm63xx-iudma";
			reg = <0x1000d800 0x600>;
			interrupt-parent = <&periph_intc>;
			interrupts = <1>, <64>, <2>, <65>, <3>, <66>, <4>, <67>;
			#dma-cells = <1>;
			dma-channels = <8>;
			dma-requests = <127>;
			status = "disabled";
		};

		enetsw0: ethernet@0x10700000 {
			compatible = "brcm,bcm63168-enetsw", "brcm,bcm63xx-enetsw";
			reg = <0x10700000 0x10000>;
			interrupt-parent = <&periph_intc>;
			interrupts = <48>;
			clocks = <&periph_clk 10>;
			reset = <&perf_soft_rst 4>;
			power-supply = <&power_robosw>;
			dmas = <&enetdma0 0	/* read channel */
				&enetdma0 1	/* write channel */
				&enetdma0 2	/* read channel */
				&enetdma0 3	/* write channel */
				&enetdma0 4	/* read channel */
				&enetdma0 5	/* write channel */
				&enetdma0 6	/* read channel */
				&enetdma0 7>;	/* write channel */
			dma-names = "rx", "tx", "rx", "tx", "rx", "tx", "rx", "tx";
			brcm,phy-ids = <1>, <2>, <3>, <4>;
			brcm,port-names = "fe2", "fe3", "fe4", "fe1";
			status = "disabled";
		};

		ehci0: usb@0x10002500 {
			compatible = "brcm,bcm63168-ehci", "brcm,bcm63xx-ehci", "generic-ehci";
			reg = <0x10002500 0x100>;
			big-endian;
			interrupt-parent = <&periph_intc>;
			interrupts = <10>;
			clocks = <&periph_clk 13>, <&timer_clk 18>;
			phys = <&usbh>;
			status = "disabled";
		};

		ohci0: usb@0x10002600 {
			compatible = "brcm,bcm63168-ohci", "brcm,bcm63xx-ohci", "generic-ohci";
			reg = <0x10002600 0x100>;
			big-endian;
			no-big-frame-no;
			interrupt-parent = <&periph_intc>;
			interrupts = <9>;
			clocks = <&periph_clk 13>, <&timer_clk 18>;
			phys = <&usbh>;
			status = "disabled";
		};

		usbh: usbphy@0xb0002700 {
			compatible = "brcm,bcm63168-usbh";
			reg = <0x10002700 0x38>;
			clocks = <&periph_clk 13>, <&timer_clk 18>;
			resets = <&perf_soft_rst 6>;
			power-supply = <&power_usbh>;
			#phy-cells = <0>;
			status = "disabled";
		};
	};
};
